# Layer0 éªŒè¯æ‰€éœ€æ•°æ®æ–‡ä»¶

## ğŸ“ è¯·å°†ä»¥ä¸‹æ–‡ä»¶æ”¾å…¥ `hls_testdata/layer0/` ç›®å½•

ä»æœåŠ¡å™¨ä¸Šä¼ çš„æ•°æ®éœ€è¦åŒ…å«ä»¥ä¸‹ **6 ä¸ª txt æ–‡ä»¶**:

### 1. `input.txt` - è¾“å…¥ç‰¹å¾å›¾
```
# Shape: (batch, in_channels, time_frames, num_vertices)
# æœŸæœ›ç»´åº¦: [1, 4, 10, 42] = 1680 ä¸ªå€¼
# æ ¼å¼: æ¯è¡Œä¸€ä¸ªæµ®ç‚¹æ•°
-0.123456
0.234567
...
```

### 2. `weight.txt` - å·ç§¯æƒé‡
```
# Shape: (out_channels, in_channels, num_neighbors)
# æœŸæœ›ç»´åº¦: [32, 4, 7] = 896 ä¸ªå€¼
# æ ¼å¼: æ¯è¡Œä¸€ä¸ªæµ®ç‚¹æ•°
0.012345
-0.067890
...
```

### 3. `bias.txt` - åç½®
```
# Shape: (out_channels,)
# æœŸæœ›ç»´åº¦: [32] = 32 ä¸ªå€¼
# æ ¼å¼: æ¯è¡Œä¸€ä¸ªæµ®ç‚¹æ•°
0.001234
-0.002345
...
```

### 4. `neighbors.txt` - é‚»å±…ç´¢å¼•è¡¨ âš ï¸
```
# Shape: (num_vertices, num_neighbors)
# æœŸæœ›ç»´åº¦: [42, 7] = 294 ä¸ªæ•´æ•°ç´¢å¼•
# æ ¼å¼: æ¯è¡Œä¸€ä¸ªæ•´æ•° (0-41)
# è¯´æ˜: neighbors[v][n] è¡¨ç¤ºé¡¶ç‚¹ v çš„ç¬¬ n ä¸ªé‚»å±…çš„ç´¢å¼•
0
1
2
...
```

### 5. `output.txt` - PyTorch å‚è€ƒè¾“å‡º
```
# Shape: (batch, out_channels, time_frames, num_vertices)
# æœŸæœ›ç»´åº¦: [1, 32, 10, 42] = 13440 ä¸ªå€¼
# æ ¼å¼: æ¯è¡Œä¸€ä¸ªæµ®ç‚¹æ•°
# è¯´æ˜: è¿™æ˜¯ PyTorch è¿è¡Œ Layer0 IcoConv åçš„è¾“å‡º,ç”¨äºå¯¹æ¯”éªŒè¯
-0.977974
-0.741672
...
```

### 6. `config.txt` - é…ç½®ä¿¡æ¯ (å¯é€‰)
```
R_LEVEL=2
NUM_VERTICES=42
TIME_FRAMES=10
IN_CHANNELS=4
OUT_CHANNELS=32
NUM_NEIGHBORS=7
```

## âš ï¸ å½“å‰çŠ¶æ€æ£€æŸ¥

ä½ å·²ä¸Šä¼ :
- âœ… `Layer0_IcoConv_output_sample.txt` - ä½†åªæœ‰ 100 ä¸ªæ ·æœ¬å€¼

ä½ è¿˜éœ€è¦æä¾›:
- âŒ `input.txt` - å®Œæ•´çš„ 1680 ä¸ªè¾“å…¥å€¼
- âŒ `weight.txt` - å®Œæ•´çš„ 896 ä¸ªæƒé‡å€¼
- âŒ `bias.txt` - å®Œæ•´çš„ 32 ä¸ªåç½®å€¼
- âŒ `neighbors.txt` - å®Œæ•´çš„ 294 ä¸ªé‚»å±…ç´¢å¼•
- âŒ `output.txt` - å®Œæ•´çš„ 13440 ä¸ªè¾“å‡ºå€¼ (ç›®å‰åªæœ‰ 100 ä¸ªæ ·æœ¬)

## ğŸ”§ å¦‚ä½•ä»æœåŠ¡å™¨å¯¼å‡ºå®Œæ•´æ•°æ®

åœ¨ä½ çš„ Python è°ƒè¯•è„šæœ¬ä¸­æ·»åŠ :

```python
import torch
import numpy as np

# å‡è®¾ä½ å·²ç»æœ‰äº† input, weight, bias, neighbors, output è¿™äº›å¼ é‡

def save_for_hls(name, tensor, save_dir='hls_testdata/layer0'):
    """ä¿å­˜ä¸º HLS å¯è¯»çš„ txt æ ¼å¼"""
    import os
    os.makedirs(save_dir, exist_ok=True)
    
    data = tensor.detach().cpu().numpy() if isinstance(tensor, torch.Tensor) else tensor
    
    with open(f'{save_dir}/{name}.txt', 'w') as f:
        f.write(f"# Shape: {data.shape}\n")
        flat = data.flatten()
        for val in flat:
            f.write(f"{val:.8f}\n")
    
    print(f"âœ“ Saved {name}: {data.shape} -> {len(flat)} values")

# å¯¼å‡ºç¤ºä¾‹
save_for_hls('input', input_tensor)
save_for_hls('weight', weight_tensor)
save_for_hls('bias', bias_tensor)
save_for_hls('neighbors', neighbors_array)
save_for_hls('output', output_tensor)
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®é¡ºåº**: å¿…é¡»æ˜¯ flatten åçš„**è¡Œä¼˜å…ˆé¡ºåº** (C-order)
2. **æµ®ç‚¹ç²¾åº¦**: å»ºè®®ä¿ç•™ 6-8 ä½å°æ•°
3. **æ•´æ•°ç´¢å¼•**: `neighbors.txt` å¿…é¡»æ˜¯æ•´æ•°,ä¸è¦æœ‰å°æ•°ç‚¹
4. **å®Œæ•´æ€§**: ä¸è¦åªä¿å­˜æ ·æœ¬,éœ€è¦**å…¨éƒ¨æ•°æ®**

## âœ… éªŒè¯æ•°æ®æ˜¯å¦æ­£ç¡®

å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤å¿«é€Ÿæ£€æŸ¥:

```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls hls_testdata/layer0/

# æ£€æŸ¥è¡Œæ•° (Windows PowerShell)
Get-Content hls_testdata/layer0/input.txt | Measure-Object -Line
# æœŸæœ›: 1681 è¡Œ (1 è¡Œæ³¨é‡Š + 1680 ä¸ªå€¼)

Get-Content hls_testdata/layer0/weight.txt | Measure-Object -Line
# æœŸæœ›: 897 è¡Œ (1 è¡Œæ³¨é‡Š + 896 ä¸ªå€¼)

Get-Content hls_testdata/layer0/output.txt | Measure-Object -Line
# æœŸæœ›: 13441 è¡Œ (1 è¡Œæ³¨é‡Š + 13440 ä¸ªå€¼)
```
