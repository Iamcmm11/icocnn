/**
 * @file types.h
 * @brief 数据类型定义
 * @author Cross3D C Implementation
 * @date 2024
 * 
 * 该文件定义了系统使用的所有数据类型，
 * 包括复数、音频帧、FFT结果等结构体。
 */

#ifndef TYPES_H
#define TYPES_H

#include <stdint.h>
#include "config.h"

/*============================================================================
 * 基本数据类型
 *============================================================================*/
typedef float           float32_t;
typedef double          float64_t;
typedef int16_t         audio_sample_t;     /* 16位音频采样 */

/*============================================================================
 * 复数类型
 *============================================================================*/
typedef struct {
    float32_t real;     /* 实部 */
    float32_t imag;     /* 虚部 */
} complex_t;

/*============================================================================
 * 音频帧结构
 *============================================================================*/
typedef struct {
    float32_t data[NUM_CHANNELS][FRAME_LENGTH];  /* 多通道音频数据 */
    int frame_index;                              /* 帧索引 */
} audio_frame_t;

/*============================================================================
 * FFT结果结构
 *============================================================================*/
typedef struct {
    complex_t data[NUM_CHANNELS][FFT_BINS];      /* 多通道FFT结果 */
} fft_result_t;

/*============================================================================
 * GCC-PHAT结果结构
 *============================================================================*/
typedef struct {
    float32_t data[NUM_MIC_PAIRS][GCC_LENGTH];   /* 所有麦克风对的GCC结果 */
} gcc_result_t;

/*============================================================================
 * SRP-Map结果结构
 *============================================================================*/
typedef struct {
    float32_t data[SRP_ELEVATION_BINS][SRP_AZIMUTH_BINS][SRP_RANGE_BINS];
} srp_map_t;

/*============================================================================
 * Tau Table结构 (用于SRP投影)
 *============================================================================*/
typedef struct {
    int tau_indices[NUM_MIC_PAIRS][TAU_TABLE_SIZE];  /* 时延索引表 */
} tau_table_t;

/*============================================================================
 * 麦克风对索引结构
 *============================================================================*/
typedef struct {
    int mic1;           /* 第一个麦克风索引 */
    int mic2;           /* 第二个麦克风索引 */
} mic_pair_t;

/*============================================================================
 * 麦克风位置结构
 *============================================================================*/
typedef struct {
    float32_t x;        /* X坐标 (m) */
    float32_t y;        /* Y坐标 (m) */
    float32_t z;        /* Z坐标 (m) */
} mic_position_t;

/*============================================================================
 * 处理状态枚举
 *============================================================================*/
typedef enum {
    STATUS_OK = 0,
    STATUS_ERROR_FILE_NOT_FOUND,
    STATUS_ERROR_MEMORY_ALLOC,
    STATUS_ERROR_INVALID_PARAM,
    STATUS_ERROR_FFT_FAILED,
    STATUS_ERROR_DATA_OVERFLOW
} status_t;

#endif /* TYPES_H */
